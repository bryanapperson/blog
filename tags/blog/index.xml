<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><docs>https://blogs.law.harvard.edu/tech/rss</docs><title>blog on Bryan Apperson</title><link>https://bryanapperson.com/tags/blog/</link><description>Recent content in blog on Bryan Apperson</description><image><title>blog on Bryan Apperson</title><link>https://bryanapperson.com/tags/blog/</link><url>https://source.unsplash.com/collection/983219/2000x1322</url></image><ttl>1440</ttl><generator>Hugo 0.81.0</generator><language>en-US</language><copyright>Copyright &amp;copy; Bryan Apperson. Licensed under CC-BY-ND-4.0. Hosted on Github.</copyright><lastBuildDate>Sun, 18 Apr 2021 21:08:54 UT</lastBuildDate><atom:link href="https://bryanapperson.com/tags/blog/index.xml" rel="self" type="application/rss+xml"/><item><title>From WordPress to Hugo</title><link>https://bryanapperson.com/blog/from-wordpress-to-hugo/</link><pubDate>Mon, 17 Feb 2020 00:00:00 UT</pubDate><dc:creator>Bryan Apperson</dc:creator><guid>https://bryanapperson.com/blog/from-wordpress-to-hugo/</guid><description>Hugo static blogs are awesome Migrating to Hugo It is 2019, enter the brave new world of serverless computing and static blogging. After years of using WordPress, and a few years without any updates this blog is in need of a refresh. When I originally created this blog I had servers (a whole web hosting company in fact). Now I just want to be able to create content and have a lightning fast website that is easy to maintain.</description><content:encoded><![CDATA[    Hugo static blogs are awesome    Migrating to Hugo It is 2019, enter the brave new world of serverless computing and static blogging. After years of using WordPress, and a few years without any updates this blog is in need of a refresh. When I originally created this blog I had servers (a whole web hosting company in fact). Now I just want to be able to create content and have a lightning fast website that is easy to maintain.
Earlier today I was doing some research, came across Hugo and decided to rebuild this blog using it and host it using github pages, at least initially. This site will likely be a work in progress for some time, however at least the text of the old content is migrated now. As I do this migration I will put out a series of articles on the how and the why of the migration.
Why Hugo and the Coder theme? Hugo is lightning fast at rendering pages and simple to use, plus the workflow with github pages is straightforward. The coder theme was chosed for now because I like the aesthetics.
Migrating from Wordpress I wanted a pretty fresh start, so I just used WordPress to export XML and then found a script here. Then I modified it for python 3 as follows:
#!/usr/bin/env python3 &amp;#34;&amp;#34;&amp;#34; This script is used to convert a WordPress XML dump to Hugo-formatted posts. NOTE: The WP post data is kept as-is (probably HTML). It is not converted to Markdown. This is to reduce the amount of &amp;#34;fixing&amp;#34; one has to do after the data is converted (e.g. line endings, links, etc). This is generally not an issue since Markdown allows HTML. The post Metadata is converted to TOML. The posts are written as: &amp;lt;year&amp;gt;/&amp;lt;title&amp;gt;.md where &amp;lt;year&amp;gt; is the year the post was written, and &amp;lt;title&amp;gt; is the WP title with all non-word characters replaced with &amp;#34;-&amp;#34;, and converted to lower case. &amp;#34;&amp;#34;&amp;#34; # Imports ###################################################################### import os import re import maya import time import calendar import xml.etree.ElementTree as ET from distutils.version import LooseVersion # Metadata ##################################################################### __author__ = &amp;#34;Timothy McFadden&amp;#34; __creationDate__ = &amp;#34;07/24/2015&amp;#34; __license__ = &amp;#34;MIT&amp;#34; __version__ = &amp;#34;1.0.0dev&amp;#34; # Globals ###################################################################### DEBUG = False KNOWN_WP_VERSION = LooseVersion(&amp;#34;4.2&amp;#34;) def hugo_format(data): result = [&amp;#34;&#43;&#43;&#43;&amp;#34;] for heading in [&amp;#34;title&amp;#34;, &amp;#34;date&amp;#34;, &amp;#34;type&amp;#34;]: result.append(&amp;#39;%s= &amp;#34;%s&amp;#34;&amp;#39; % (heading, data[heading])) result.append(&amp;#34;tags = %s&amp;#34; % str(data[&amp;#34;tags&amp;#34;])) result.append(&amp;#34;&#43;&#43;&#43;&amp;#34;) result.append(&amp;#34;&amp;#34;) result.append(data[&amp;#34;body&amp;#34;]) return &amp;#34;\n&amp;#34;.join(result) def wp_version_check(channel): match = re.search(&amp;#34;\?v=([\d\.]&#43;)&amp;#34;, channel.find(&amp;#34;generator&amp;#34;).text) if not match: print(&amp;#34;WARNING: Could not find WP version in your XML.&amp;#34;) print(&amp;#34;...This script may not work&amp;#34;) raw_input(&amp;#34;...press Enter to continue: &amp;#34;) else: wp_version = LooseVersion(match.group(1)) if wp_version &amp;lt; KNOWN_WP_VERSION: print(&amp;#34;WARNING: WP version in your XML (%s) is less than known good version (%s)!&amp;#34; % (wp_version, KNOWN_WP_VERSION)) print(&amp;#34;...This script may not work&amp;#34;) raw_input(&amp;#34;...press Enter to continue: &amp;#34;) def convert_wp_xml(xml_path): tree = ET.parse(xml_path) # FYI: xml.etree doesn&amp;#39;t support reading the namespaces, and I don&amp;#39;t feel # like requiring lxml. nsmap = { &amp;#34;excerpt&amp;#34;: &amp;#34;http://wordpress.org/export/1.2/excerpt/&amp;#34;, &amp;#34;content&amp;#34;: &amp;#34;http://purl.org/rss/1.0/modules/content/&amp;#34;, &amp;#34;wfw&amp;#34;: &amp;#34;http://wellformedweb.org/CommentAPI/&amp;#34;, &amp;#34;dc&amp;#34;: &amp;#34;http://purl.org/dc/elements/1.1/&amp;#34;, &amp;#34;wp&amp;#34;: &amp;#34;http://wordpress.org/export/1.2/&amp;#34;, } channel = tree.find(&amp;#34;channel&amp;#34;) wp_version_check(channel) for item in channel.findall(&amp;#34;item&amp;#34;): data = { &amp;#34;tags&amp;#34;: [], &amp;#34;title&amp;#34;: (item.find(&amp;#34;title&amp;#34;).text).strip(&amp;#39;\n&amp;#39;), &amp;#34;date&amp;#34;: None, &amp;#34;body&amp;#34;: None, &amp;#34;fpath&amp;#34;: None, &amp;#34;type&amp;#34;: &amp;#34;post&amp;#34; } scraped_time = item.find(&amp;#34;pubDate&amp;#34;).text datetime = maya.parse(scraped_time).datetime(to_timezone=&amp;#39;US/Eastern&amp;#39;, naive=True) data[&amp;#34;date&amp;#34;] = datetime data[&amp;#34;tags&amp;#34;] = [x.attrib[&amp;#34;nicename&amp;#34;] for x in item.findall(&amp;#34;category&amp;#34;)] data[&amp;#34;body&amp;#34;] = item.find(&amp;#34;content:encoded&amp;#34;, nsmap).text fname = re.sub(&amp;#34;\W&#43;&amp;#34;, &amp;#34;-&amp;#34;, data[&amp;#34;title&amp;#34;]) fname = re.sub(&amp;#34;(-&#43;)$&amp;#34;, &amp;#34;&amp;#34;, fname) fname = fname[1:] data[&amp;#34;fname&amp;#34;] = &amp;#34;{}.md&amp;#34;.format(fname.lower()) data[&amp;#34;fdir&amp;#34;] = os.path.abspath(os.path.join(&amp;#34;.&amp;#34;, str(datetime.year))) data[&amp;#34;fpath&amp;#34;] = os.path.join(data[&amp;#34;fdir&amp;#34;], data[&amp;#34;fname&amp;#34;]) hugo_text = hugo_format(data) if not os.path.isdir(data[&amp;#34;fdir&amp;#34;]): os.makedirs(data[&amp;#34;fdir&amp;#34;]) with open(data[&amp;#34;fpath&amp;#34;], &amp;#34;wb&amp;#34;) as fh: fh.write(hugo_text.encode(&amp;#39;UTF-8&amp;#39;)) print(&amp;#34;Created: {}/{}&amp;#34;.format(datetime.year, data[&amp;#34;fname&amp;#34;])) if __name__ == &amp;#39;__main__&amp;#39;: import sys if len(sys.argv) == 1: print(&amp;#34;Usage: python wp_to_hugo.py &amp;lt;wordpress XML file&amp;gt;&amp;#34;) sys.exit(1) convert_wp_xml(sys.argv[1]) I still need to manually sift through and fix images and curate the older posts have now updated all of the older posts.
Github Pages I chose github pages because I already have a github account and the workflow seemed good. Plus there is an easy way I plan to automate publishing master using travis-ci in the near future have automated publishing. I followed the Hugo docs, using the gh-pages branch based workflow. The repo for this blog now lives here.
Travis CI I adapted this guide on Travis CI and Hugo to automate the build and publish of my blog to github pages. It is pretty straightforward and I highly recommend it.
Here is the .travis.yml that I ended up with after optimizing a bit for faster builds of Hugo:
# Credit to:#https://axdlog.com/2018/using-hugo-and-travis-ci-to-deploy-blog-to-github-pages-automatically/# https://docs.travis-ci.com/user/deployment/pages/# https://docs.travis-ci.com/user/reference/xenial/# https://docs.travis-ci.com/user/languages/go/# https://docs.travis-ci.com/user/customizing-the-build/cache:directories:- $HOME/.cache/go-build- $HOME/gopath/pkg/moddist:xeniallanguage:gogo:- 1.12.x# Only clone the most recent commit.git:depth:1# before_install# install - install any dependencies requiredinstall:- go get github.com/gohugoio/hugobefore_script:- rm -rf public 2&amp;gt; /dev/null# script - run the build scriptscript:- hugodeploy:provider:pagesskip-cleanup:truegithub-token:$GITHUB_TOKEN# Set in travis-ci.org dashboard, marked secureemail:$GITHUB_EMAILname:$GITHUB_USERNAMEverbose:truelocal-dir:publicfqdn:bryanapperson.comon:branch:master# branch contains Hugo generator codeConclusion Overall the initial learning curve, setup, customization and migration took about 8 hours. I would say that is pretty good. There will definitely be more posts to follow on my journey with blogging using Hugo.
]]></content:encoded></item></channel></rss>